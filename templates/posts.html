{% extends 'flatpages/default.html' %}

{% load custom_filters %}

{% load custom_tags %}

{% block title %}
POSTS
{% endblock title %}

{% block content %}

<h2>Number of posts: {{posts|length}}</h2>
<table>
    <tr>
        <td>ID</td>
        <td>Heading</td>
        <td>Publication date</td>
        <td>Post type</td>
        <td>Content begin</td>
        <td>Rating</td>
    </tr>
    {% for post in posts %}
    <tr>
        <td>{{ post.pk  }}</td>
        <td>{{ post.post_title }}</td>
        <td>{{ post.time_create|date:'d M Y'}}</td>
        <td>{{ post.get_type_post_display }}</td>
        <td>{{ post.post_content|truncatechars:20|censor }}</td>
        <td>{{ post.post_rating }}</td>
        <td> <a href="/news/{{post.pk}}">
                 Просмотр {% if post.type_post == 'A' %}статьи{%else%}новости{% endif %}
             </a>
        </td>
    </tr>
    {% endfor %}
</table>


 {# Добавляем пагинацию на страницу #}

   {# Информация о предыдущих страницах #}
   {% if page_obj.has_previous %}
       <a href="?page=1">1</a>
       {% if page_obj.previous_page_number != 1 %}
           ...
           <a href="?page={{ page_obj.previous_page_number }}">{{ page_obj.previous_page_number }}</a>
       {% endif %}
   {% endif %}

   {# Информация о текущей странице #}
   {{ page_obj.number }}

   {# Информация о следующих страницах #}
   {% if page_obj.has_next %}
       <a href="?page={{ page_obj.next_page_number }}">{{ page_obj.next_page_number }}</a>
       {% if paginator.num_pages != page_obj.next_page_number %}
           ...
           <a href="?page={{ page_obj.paginator.num_pages }}">{{ page_obj.paginator.num_pages }}</a>
       {% endif %}
   {% endif %}

   {# Ссылки на создание новости, статьи #}
    <h5>
        <a href="/news/create">Создать новость</a>
    </h5>
     <h5>
        <a href="/articles/create">Создать статью</a>
    </h5>

<hr>

<h5>
        <a href="/news/search">
            Выборка новостей с фильтром поиска
        </a>
</h5>

<p>
    user: {{ request.user }}
</p>
{% if not perms.app_NewsPortal_module20.add_post%}
    <p>
        <a href="/accounts/upgrade_to_author">Хочу быть автором</a>
    </p>
{% else %}
    <p>
        Пользователь с правами автора</a>
    </p>
{% endif %}

{% endblock content %}